﻿﻿﻿﻿﻿﻿﻿**Website's Domain:**﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿ www.18.209.149.221.xip.ioHere is a list of all the steps to deploy the catalog web app on the internet.#1. Creating an Instance of the Linux Server:I. Create an Amazon light sail account and log in.ii. From the list of services select lightsail. On the next page click create an instance.iii. Choose an instance Ubuntu image and then click OS only. Then choose Ubuntu as the operating system.iv. Choose your instance plan. For this project choose the lowest tier.v. Give your instance a hostname. You can choose any name you want e.g. ubuntu as long as it doesn't spaces or unusual characters in it.vi. It may take up a few minutes to start up. It will then display a public IP address. Now you can SSH into the server by clicking Connect using SSH. #2. Securing the server:I. Logged in as the ubuntu user, use the sudo command to run the following instructions as root.$sudo apt-get update$sudo apt-get upgradeii. Update the /etc/ssh/sshd_config file to include port 2200 under what port to listen to by using: $sudo nano /etc/ssh/sshd_configThen under Permit root login, change yes to prohibit-password to prevent remote root login.Then press CTRL+X, type Y and press Enter to save the file.iii. Change the timezone to utc by :$sudo timedatectl set-timezone UTCiv. Next configure the firewall to allow the following connections:$sudo ufw allow 2200/tcp$sudo ufw allow 80/tcp $sudo ufw allow 123/tcp$sudo ufw enablev. On your amazon instance page, click on the three dots next to your instances's name, then click Manage. After that click networking. Add the UDP custom port 123 and TCP custom port 2200. Delete the SSH port 22. Then save all these changes.vi. After configuring the firewall you wont be able to SSH into your instace using the browser as it will assume that the instance is still listening on port 22. To SSH into the instance using port 2200 you will need a third party client known as Putty.#3. Logging into the server as ubuntu using Putty:i. Go [putty.org](http://putty.org) and click here.ii. Download the installer based on your machine.iii. Complete and the installation. Then download puttygen.exe(which is an RSA and DSA key generation utility) and install it on your machine as well.iv. On your amazon instance page again go to Manage by clicking three dots next to your instance and then go to networking tab and generate a public static IP address and note it down.v. Now get your lightsail key by going to your account page. Then click SSH key and then click on download. It will be downloaded as your lightsail key for your instance.vi. Once Downloaded, open puttygen. Then click on Load and load your lightsail key that you just downloaded. Then click Generate and then click save your public key. Name this key puttykey or any other easy name. vii. Now open putty and under hostname type your public static IP address and then type port number as 2200. Finally expand SSH and under Auth browse your computer to load the putty key(*puttykey*) that you just saved. Then click Open. When asked to login as: , enter ubuntu. There you have it, you will logged in as ubuntu into your server using port 2200.#4. Create another user called grader:i. To create another user called grader, run the following command:$sudo adduser graderii. In order to give the user permission to sudo, create a new file , $sudo nano /etc/sudoers.d/graderand type the following line in it:grader ALL = (ALL:ALL)Press Ctrl+X, type Y and then press Enter to save the file.iii. To login as grader type :$su -l graderiv. To generate an SSH key for grader type the following command:$ssh-keygen -t rsa -P ' ' -f ~/.ssh/id_rsa cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keysThen run :$sudo nano /home/grader/.ssh/id_rsaCopy the file contents by selecting all the text and paste it on an empty file in any editor.v. Now type exit and you will be logged in as ubuntu again. Close the terminal and open the folder which contains the lightsail.pem key that you saved from amazon's website. Make a copy of it and rename it as id_rsa_grader.pem. Now open the file id_rsa_grader.pem with any text editor like sublime or notepad++, removw all the file contents and paste all the contents which were copied in an empty file from the step above. Save and close the file.vi. To login as the grader in your instance server, you need a putty key for the grader. For this open putty gen and load the id_rsa_grader.pem key and click generate. Then save the key as puttykeygrader or any other name for easy reference. For logging in, open putty and under hostname put your public static ip address, port 2200 and under SSH, then Auth browse to load the puttykeygrader and click open. When asked to login as:, type grader and you will be logged in as grader.#5. Installing Apache2:i.( logged in as ubuntu)Now to install apache2 run:$sudo apt-get install apache2$sudo apt-get install libapache2-mod-wsgi python-dev(mod-wsgi is an ApacheHTTP server module which provides wsgi compliant interface for hosting python based web applications under apache.)Now if you put your static public ip address in the browser you will see default apache web page if the installation was successful.#6. Getting catalog app code from GitHub:i. Now run the following command to get into the apache root directory:$cd /var/www$git clone [url of your catalog repo on GitHub]You maybe asked to enter your GitHub username and password.ii. Now for your catalog app's communication witrh server, we have to make a wsgi file, so type:$sudo nano /var/www/catalog/catalog.wsgiand type the following into the file:`#!/usr/bin/pythonimport loggingimport syslogging.basicConfig(stream=sys.stderr)sys.path.insert(0,"/var/www/catalog/")from ____init____ import app as applicationapplication.secret_key='super_secret_key'`#7. Configuring your catalog app:i. Now since application's code is in the file application.py, we need to copy it in the new file called ____init____.py so our wsgi can pick the code from it. so type:$sudo cp /var/www/catalog/application.py /var/www/catalog/____init____.pyii. Now open the init.py file by:$sudo nano /var/www/catalog/_____init____.pyand change the path of client id to:CLIENT_ID = json.loads(open('/var/www/catalog/client__secrets.json'),'r').read()['web']['client__id']iii. Now to create catalog app's configuration file, type:$sudo nano /etc/apache/sites-available/catalog.confand paste the following code in it:`<VirtualHost *:80>    ServerName 18.209.149.221WSGIDaemonProcess catalog python-path=/var/www/catalog:/var/www/catalog/ven$   WSGIProcessGroup catalog    WSGIScriptAlias / /var/www/catalog/catalog.wsgi    <Directory /var/www/catalog/>        Order allow,deny        Allow from all    </Directory>    Alias /static /var/www/catalog/static    <Directory /var/www/catalog/static/>        Order allow,deny        Allow from all    </Directory>    ErrorLog ${APACHE_LOG_DIR}/error.log    LogLevel warn    CustomLog ${APACHE_LOG_DIR}/access.log combined</VirtualHost>`#8. Installing pip, flask and other modules:i. Now open the file ____init____.py and note down the name of all the packages(e.g. flask sql alchemy etc) that the app uses, by typing:$sudo nano /var/www/catalog/____init___.pyii. Now install pip and all these packages by typing:$sudo apt-get install python-pip$pip install flask httplib2 oauth2client sqlachemy psycopg2**note**(If there is an import error then install the required package. You can check these errors by sudo cat/var/log/apache2/error.log)#9.Installing PostgreSQL:i. Run the following command to install PostgreSQL:$sudo apt-get install postgresql postgresql-contribThen to login as the default user postgres, use:$sudo -u postgres psqlYou will be logged in as postgres in psql, to save a password for user postgres type: postgres=#\password then choose and type a password and save it. Now type the following commands to create a user catalog with a catalog database:CREATE USER catalog WITH PASSWORD [your-password];ALTER USER catalog CREATEDB;CREATE DATABASE catalog WITH OWNER catalog;Connect to the catalog database:postgres=#\c catalogand type:REVOKE ALL ON SCHEMA public FROM public;GRANT ALL ON SCHEMA public FROM public;GRANT ALL ON SCHEMA public TO catalog;Type exit to quit the the catalog user and then type \q in postgres to return to your terminal.ii. Since we are using PostgreSQL for our project, so open these files one by one:$sudo nano /var/www/catalog/database_setup.py$sudo nano /var/www/catalog/lotsofitems.py$sudo nano/var/www/catalog/____init____.pyand change the path of engine to:engine = create_engine('postgresql://catalog:[your-password]@localhost/catalog')#10.Setting Up OAuth:i. For OAuth to work properly, you need to create a domain name for you web app, go to [console.developers.google.com](http://console.developers.google.com) and click on your web app(Catalog App in our case). Then click credentials. Then go to OAuth consent screen. Under Authorized domains add:yourstaticipaddress.xip.ioThen click save.ii. Now click Credentials and select webclient1, open it. Under Authorized JavaScript Origins, type:http://www.youripaddress.xip.ioUnder Authorized redirect uri's add:http://www.youripaddress.xip.io/loginhttp://www.youripaddress.xip.io/gconnectThen click Save.Then on the same page click download JSON and save this new file. Open this file using any text editor. Copy its contents, then run:$sudo nano /var/www/catalog/client_secrets.jsonRemove all of its contents and paste the contents copied from the json file downloaded above. Then press Ctrl+X, type Y and press Enter to  save the file.#11.Running the catalog app code:i. Now go into the directory:cd /var/www/catalogThen run:$python database_setup.pythen:$python lotsofitems.pythen finally to run our code:$python ____init____.pyNow visit http://www.youripaddress.xip.io and hopefully if all goes well, it will show your app live on the internet. #12. List of third party resources:https://www.youtube.com/watch?v=-nDeELJiod0https://knowledge.udacity.comhttp://leonwang.me/post/deploy-flaskhttps://umar-yusuf.blogspot.com/2018/02/deploying-python-flask-web-app-on.htmlhttps://blog.theodo.fr/2017/03/developping-a-flask-web-app-with-a-postresql-database-making-all-the-possible-errors/